{"ast":null,"code":"var _jsxFileName = \"/mnt/c/Users/taylo/source/react/Legato/sj2legato/savelegato/src/view/signin.js\";\nimport React, { Component } from \"react\";\nimport Form from \"react-validation/build/form\";\nimport Input from \"react-validation/build/input\";\nimport { isEmail } from \"validator\";\nimport AuthService from \"../services/auth.service\";\nimport CheckButton from \"react-validation/build/button\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst email = value => {\n  if (!isEmail(value)) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"alert alert-danger\",\n      role: \"alert\",\n      children: \"This is not a valid email.\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 13,\n      columnNumber: 13\n    }, this);\n  }\n}; //this component signs in a teacher allready in the database.\n//using react-validation.\n\n\nconst required = value => {\n  if (!value) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"alert alert-danger\",\n      role: \"alert\",\n      children: \"This field is required!\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 25,\n      columnNumber: 13\n    }, this);\n  }\n};\n\nexport default class Login extends Component {\n  componentDidMount() {\n    let auth = AuthService.getCurrentUser();\n\n    if (auth) {\n      if (auth.role === \"teacher\") {\n        this.props.history.push(\"/profile\");\n        window.location.reload();\n      }\n\n      if (auth.role === \"student\") {\n        this.props.history.push(\"/student_routes\");\n        window.location.reload();\n      }\n    }\n  } //state creation and binding.\n\n\n  constructor(props) {\n    super(props);\n\n    this.handleChange = event => {\n      const {\n        name,\n        value\n      } = event.target;\n      this.setState({\n        [name]: value\n      });\n    };\n\n    this.handleLogin = this.handleLogin.bind(this);\n    this.handleChange = this.handleChange.bind(this); //this.onChangePassword = this.onChangePassword.bind(this);\n\n    this.state = {\n      email: \"\",\n      password: \"\",\n      loading: false,\n      message: \"\",\n      attempts: 0\n    };\n  } //handles all changes with state.\n\n\n  //submites for login using the controller to connect with backend. Sends to the teacher profile if teacher or the student if back end spits out student.\n  handleLogin(e) {\n    e.preventDefault();\n    this.props.currentuser;\n    let attempt = this.state.attempts + 1;\n    this.setState({\n      message: \"\",\n      loading: true,\n      attempts: attempt\n    });\n    this.form.validateAll();\n\n    if (this.checkBtn.context._errors.length === 0) {\n      if (!this.state.email || !this.state.password) {\n        this.setState({\n          message: \"Please include correct email and password\"\n        });\n      } else {\n        var lower = this.state.email.toLowerCase();\n        AuthService.login(lower, this.state.password).then(response => {\n          //console.log(response);\n          if (response.role === \"admin\") {\n            this.props.history.push(\"/admin\");\n            window.location.reload();\n          } else {\n            if (response.role === \"student\") {\n              console.log(response.data);\n              this.props.history.push({\n                pathname: \"/student_routes\",\n                state: {\n                  current: response.data\n                }\n              });\n              window.location.reload();\n            } else {\n              this.props.history.push(\"/profile\");\n              window.location.reload();\n            }\n          }\n        }, error => {\n          const resMessage = error.response && error.response.data && error.response.data.message || error.message || error.toString();\n          this.setState({\n            loading: false,\n            message: resMessage\n          });\n        });\n      }\n    } else {\n      this.setState({\n        loading: false\n      });\n    }\n  }\n\n  render() {\n    //login page for the screen. \n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"z\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"col-md-12\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"card card-container\",\n          children: [/*#__PURE__*/_jsxDEV(\"img\", {\n            src: \"//ssl.gstatic.com/accounts/ui/avatar_2x.png\",\n            alt: \"profile-img\",\n            className: \"profile-img-card\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 144,\n            columnNumber: 21\n          }, this), this.state.attempts < 3 ? /*#__PURE__*/_jsxDEV(Form, {\n            onSubmit: this.props.handleLogin.bind(this, {\n              currentUser: true,\n              student: true\n            }),\n            ref: c => {\n              this.form = c;\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"form-group\",\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                htmlFor: \"Email\",\n                children: \"Email\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 157,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(Input, {\n                type: \"text\",\n                className: \"form-control\",\n                name: \"email\",\n                value: this.props.state.email,\n                onChange: this.props.handleChange,\n                validations: [required, email],\n                maxlength: \"30\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 158,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 156,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"form-group\",\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                htmlFor: \"password\",\n                children: \"Password\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 170,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(Input, {\n                type: \"password\",\n                className: \"form-control\",\n                name: \"password\",\n                value: this.props.state.password,\n                onChange: this.props.handleChange,\n                validations: [required],\n                maxlength: \"20\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 171,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 169,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"form-group\",\n              style: {\n                marginTop: \"37px\"\n              },\n              children: /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"btn  btn-block\",\n                style: {\n                  background: \"#696eb5\",\n                  height: \"35px\",\n                  color: \"#F0F2EF\",\n                  width: \"85spx\"\n                },\n                disabled: this.state.loading,\n                children: [this.state.loading && /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"spinner-border spinner-border-sm\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 189,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: \"Login\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 191,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 184,\n                columnNumber: 37\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 183,\n              columnNumber: 33\n            }, this), this.state.message && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"form-group\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"alert alert-danger\",\n                role: \"alert\",\n                children: this.state.message\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 197,\n                columnNumber: 41\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 196,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(CheckButton, {\n              style: {\n                display: \"none\"\n              },\n              ref: c => {\n                this.checkBtn = c;\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 202,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 150,\n            columnNumber: 29\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"alert alert-danger\",\n            children: \"You have Reached the Maximum Attempts to login.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 209,\n            columnNumber: 30\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 143,\n          columnNumber: 17\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 13\n    }, this);\n  }\n\n}","map":{"version":3,"sources":["/mnt/c/Users/taylo/source/react/Legato/sj2legato/savelegato/src/view/signin.js"],"names":["React","Component","Form","Input","isEmail","AuthService","CheckButton","email","value","required","Login","componentDidMount","auth","getCurrentUser","role","props","history","push","window","location","reload","constructor","handleChange","event","name","target","setState","handleLogin","bind","state","password","loading","message","attempts","e","preventDefault","currentuser","attempt","form","validateAll","checkBtn","context","_errors","length","lower","toLowerCase","login","then","response","console","log","data","pathname","current","error","resMessage","toString","render","currentUser","student","c","marginTop","background","height","color","width","display"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport Form from \"react-validation/build/form\";\r\nimport Input from \"react-validation/build/input\";\r\nimport { isEmail } from \"validator\";\r\nimport AuthService from \"../services/auth.service\";\r\nimport CheckButton from \"react-validation/build/button\";\r\n\r\n\r\n\r\nconst email = value => {\r\n    if (!isEmail(value)) {\r\n        return (\r\n            <div className=\"alert alert-danger\" role=\"alert\">\r\n                This is not a valid email.\r\n            </div>\r\n        );\r\n    }\r\n};\r\n\r\n//this component signs in a teacher allready in the database.\r\n//using react-validation.\r\nconst required = value => {\r\n    if (!value) {\r\n        return (\r\n            <div className=\"alert alert-danger\" role=\"alert\">\r\n                This field is required!\r\n            </div>\r\n        );\r\n    }\r\n};\r\n\r\nexport default class Login extends Component {\r\n    componentDidMount() {\r\n        let auth = AuthService.getCurrentUser();\r\n        if (auth) {\r\n            if (auth.role === \"teacher\") {\r\n                this.props.history.push(\"/profile\");\r\n                window.location.reload();\r\n            }\r\n            if (auth.role === \"student\") {\r\n                this.props.history.push(\"/student_routes\");\r\n                window.location.reload();\r\n            }\r\n        }\r\n    }\r\n    //state creation and binding.\r\n    constructor(props) {\r\n        super(props);\r\n        this.handleLogin = this.handleLogin.bind(this);\r\n        this.handleChange = this.handleChange.bind(this);\r\n        //this.onChangePassword = this.onChangePassword.bind(this);\r\n\r\n        this.state = {\r\n            \r\n            email: \"\",\r\n            password: \"\",\r\n            loading: false,\r\n            message: \"\",\r\n            attempts:0,\r\n        };\r\n    }\r\n    //handles all changes with state.\r\n    handleChange = (event) => {\r\n        const { name, value } = event.target\r\n\r\n        this.setState({\r\n            [name]: value,\r\n        })\r\n    }\r\n    //submites for login using the controller to connect with backend. Sends to the teacher profile if teacher or the student if back end spits out student.\r\n    handleLogin(e) {\r\n        e.preventDefault();\r\n        this.props.currentuser\r\n        let attempt = this.state.attempts + 1;\r\n        this.setState({\r\n            message: \"\",\r\n            loading: true,\r\n            attempts: attempt\r\n        });\r\n\r\n        this.form.validateAll();\r\n\r\n        if (this.checkBtn.context._errors.length === 0)\r\n        {\r\n            if (!this.state.email || !this.state.password) {\r\n                this.setState({\r\n                    message:\"Please include correct email and password\"\r\n                })\r\n            }\r\n            else { \r\n                var lower = this.state.email.toLowerCase();\r\n            AuthService.login(lower, this.state.password).then(response => {\r\n                //console.log(response);\r\n\r\n                \r\n                if (response.role === \"admin\") {\r\n                    this.props.history.push(\"/admin\")\r\n                    window.location.reload();\r\n\r\n                }\r\n                else {\r\n                    if (response.role === \"student\") {\r\n                        console.log(response.data);\r\n                        this.props.history.push({\r\n                            pathname: \"/student_routes\",\r\n                            state: { current: response.data }\r\n                        });\r\n                        window.location.reload();\r\n                    }\r\n                    else {\r\n                        this.props.history.push(\"/profile\");\r\n                        window.location.reload();\r\n                    }\r\n                }\r\n                },\r\n                error => {\r\n                    const resMessage =\r\n                        (error.response &&\r\n                            error.response.data &&\r\n                            error.response.data.message) ||\r\n                        error.message ||\r\n                        error.toString();\r\n\r\n                    this.setState({\r\n                        loading: false,\r\n                        message: resMessage\r\n                    });\r\n                }\r\n                );\r\n            }\r\n        } else {\r\n            this.setState({\r\n                loading: false\r\n            });\r\n        }\r\n    }\r\n\r\n    render() {\r\n        //login page for the screen. \r\n        return (\r\n            <div className=\"z\">\r\n            <div className=\"col-md-12\">\r\n                <div className=\"card card-container\">\r\n                    <img\r\n                        src=\"//ssl.gstatic.com/accounts/ui/avatar_2x.png\"\r\n                        alt=\"profile-img\"\r\n                        className=\"profile-img-card\"\r\n                    />\r\n                        {this.state.attempts < 3 ? (\r\n                            <Form\r\n                                onSubmit={this.props.handleLogin.bind(this,{currentUser:true,student:true})}\r\n                                ref={c => {\r\n                                    this.form = c;\r\n                                }}\r\n                            >\r\n                                <div className=\"form-group\">\r\n                                    <label htmlFor=\"Email\">Email</label>\r\n                                    <Input\r\n                                        type=\"text\"\r\n                                        className=\"form-control\"\r\n                                        name=\"email\"\r\n                                        value={this.props.state.email}\r\n                                        onChange={this.props.handleChange}\r\n                                        validations={[required, email]}\r\n                                        maxlength=\"30\"\r\n                                    />\r\n                                </div>\r\n\r\n                                <div className=\"form-group\">\r\n                                    <label htmlFor=\"password\">Password</label>\r\n                                    <Input\r\n                                        type=\"password\"\r\n                                        className=\"form-control\"\r\n                                        name=\"password\"\r\n                                        value={this.props.state.password}\r\n                                        onChange={this.props.handleChange}\r\n                                        validations={[required]}\r\n                                        maxlength=\"20\"\r\n\r\n                                    />\r\n                                </div>\r\n\r\n                                <div className=\"form-group\" style={{marginTop:\"37px\"}}>\r\n                                    <button\r\n                                        className=\"btn  btn-block\" style={{ background: \"#696eb5\", height: \"35px\", color: \"#F0F2EF\", width: \"85spx\" }}\r\n                                        disabled={this.state.loading}\r\n                                    >\r\n                                        {this.state.loading && (\r\n                                            <span className=\"spinner-border spinner-border-sm\"></span>\r\n                                        )}\r\n                                        <span>Login</span>\r\n                                    </button>\r\n                                </div>\r\n\r\n                                {this.state.message && (\r\n                                    <div className=\"form-group\">\r\n                                        <div className=\"alert alert-danger\" role=\"alert\">\r\n                                            {this.state.message}\r\n                                        </div>\r\n                                    </div>\r\n                                )}\r\n                                <CheckButton\r\n                                    style={{ display: \"none\" }}\r\n                                    ref={c => {\r\n                                        this.checkBtn = c;\r\n                                    }}\r\n                                />\r\n                            </Form>\r\n                        ) : (<div className=\"alert alert-danger\">You have Reached the Maximum Attempts to login.</div>)}\r\n                    \r\n                </div>\r\n            </div>\r\n            </div>\r\n        );\r\n    }\r\n}"]},"metadata":{},"sourceType":"module"}